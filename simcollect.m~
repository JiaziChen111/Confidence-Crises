function[Results,assetprices,FailCount,capitalshortfall,numnodes,numedges,density_av,density_min,density_max,...
    avdegree_av,avdegree_min,avdegree_max,mu_A_av,mu_A_min,mu_A_max,mu_B_av,mu_B_min,mu_B_max] = ...
    simcollect(abmresults_allsims,abmresults_label,n_sims,sim_Results_agg,sim_Results_av,sim_Results_min,sim_Results_max,...
    assetprices,FailCount,numnodes,numedges,density,avdegree,mu_A,mu_B)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Average results across simulations before passing onto visualisation functions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Averaging across ABM runs to obtain balance sheet, interbank market and firesale results for visualitation
Results(1,:) = nanmean(sim_Results_av,3);
Results(2,:) = nanmean(sim_Results_min,3);
Results(3,:) = nanmean(sim_Results_max,3);
Results(4,:) = nanmean(sim_Results_agg,3);

assetprices = nanmean(assetprices,3);

% Average vector of bank failures across simulations
FailCount(1,:)  = mean(FailCount);
FailCount(2,:) = min(FailCount);
FailCount(3,:) = max(FailCount);

% Cumulative vector of failed banks after averaging across runs
cum_Fails_av  = cumsum(FailCount_av);
cum_Fails_min = cumsum(FailCount_min);
cum_Fails_max = cumsum(FailCount_max);

% Identity of failed banks varies across ABM runs: Compute total capital loss due to failures in each run
for k = 1:n_sims
    Failures_sims = abmresults_allsims.(abmresults_label{k}).FailedBanks; 
    NumFails  = numel(Failures_sims);
    
    capitalshortfall_vec = zeros(NumFails,T);

    for i=1:NumFails
        capitalshortfall_vec(i,Failures_sims(i).failtime) = ...
            abmresults_allsims.(abmresults_label{k}).vars.balancesheet{'Capital',end};
    end
    
    sim_capitalshortfall(k,:) = abs(sum(capitalshortfall_vec));        
end

capitalshortfall(1,:) = mean(sim_capitalshortfall);
capitalshortfall(2,:) = min(sim_capitalshortfall);
capitalshortfall(3,:) = max(sim_capitalshortfall);

% Network structure evolution across ABM runs
numnodes(1,:) = mean(numnodes);
numnodes(2,:) = min(numnodes);
numnodes(3,:) = max(numnodes);

numedges(1,:) = mean(numedges);
numedges(2,:) = min(numedges);
numedges(3,:) = max(numedges);

density(1,:)  = mean(density);
density(2,:)  = min(density);
density(3,:)  = max(density);

avdegree(1,:) = mean(avdegree);
avdegree_min = min(avdegree);
avdegree_max = max(avdegree);   

mu_A_av  = mean(mu_A); mu_A_min = min(mu_A); mu_A_max = max(mu_A);
mu_B_av  = mean(mu_B); mu_B_min = min(mu_B); mu_B_max = max(mu_B);

end